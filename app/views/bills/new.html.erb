<div data-controller="items">
  <%= form_with model: @bill do |form| %>

    <%= form.fields_for :client do |client_fields| %>

      <%= client_fields.label :name, "Nom" %>
      <%= client_fields.text_field :name %>

      <%= client_fields.label :address, "Addresse" %>
      <%= client_fields.text_field :address %>

      <%= client_fields.label :post_code, "Code postal" %>
      <%= client_fields.text_field :post_code %>

      <%= client_fields.label :city, "Ville" %>
      <%= client_fields.text_field :city %>

      <%= client_fields.label :siret_number, "SIRET" %>
      <%= client_fields.text_field :siret_number %>

      <%= client_fields.label :tva_number, "Numéro de TVA" %>
      <%= client_fields.text_field :tva_number %>

      <%= client_fields.label :email, "Email" %>
      <%= client_fields.text_field :email %>

      <%= client_fields.label :phone_number, "Téléphone" %>
      <%= client_fields.text_field :phone_number %>

    <% end %>

    <button data-action="click->items#addItem">
      <p>Ajouter un article</p>
    </button>

    <% 10.times do |i| %>
      <div data-items-target="items">
        <%= form.fields_for :item, index: i do |item_fields| %>

          <%= item_fields.label :name, "Désignation" %>
          <%= item_fields.text_field :name %>

          <%= item_fields.label :description, "Description" %>
          <%= item_fields.text_field :description %>

          <%= item_fields.label :unity, "Unité" %>
          <%= item_fields.select :unity, in: Item::UNITY %>

          <%= item_fields.label :quantity, "Quantité" %>
          <%= item_fields.text_field :quantity %>

          <%= item_fields.label :unit_price, "Prix unitaire" %>
          <%= item_fields.text_field :unit_price %>

        <% end %>
      </div>
    <% end %>

    <%= form.submit "Générer la facture" %>
  <% end %>
</div>
